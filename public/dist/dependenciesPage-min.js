"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _typeof(obj){return obj&&"undefined"!=typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj}var _lodash=require("lodash"),_lodash2=_interopRequireDefault(_lodash),_q=require("q"),_q2=_interopRequireDefault(_q),_restClient=require("dist/restClient"),_restClient2=_interopRequireDefault(_restClient),_ListView=require("dist/components/ListView"),_ListView2=_interopRequireDefault(_ListView),_AttributesHandlerEventsTable=require("dist/components/AttributesHandlerEventsTable"),_AttributesHandlerEventsTable2=_interopRequireDefault(_AttributesHandlerEventsTable),_UsageTable=require("dist/components/UsageTable"),_UsageTable2=_interopRequireDefault(_UsageTable),_ControlDetailLink=require("dist/components/ControlDetailLink"),_ControlDetailLink2=_interopRequireDefault(_ControlDetailLink),_DependenciesDetailTable=require("dist/components/DependenciesDetailTable"),_DependenciesDetailTable2=_interopRequireDefault(_DependenciesDetailTable),_MethodTable=require("dist/components/MethodTable"),_MethodTable2=_interopRequireDefault(_MethodTable),_util=require("dist/util"),_util2=_interopRequireDefault(_util),ControlDetailPage=React.createClass({displayName:"ControlDetailPage",render:function(){var _this=this;if(!this.props.controlName)return React.createElement("div",{className:"panel panel-primary"},React.createElement("div",{className:"panel-body"},"Please select a match from the left side of this page to view the detailed description"));var _ret=function(){var controlName=_this.props.controlName.toLowerCase(),shortControlName=controlName.substr(controlName,controlName.lastIndexOf(".")),dependenciesMap=_lodash2["default"].get(_this,"props.controlObj.dependencies",{}),methodsMap=_lodash2["default"].get(_this,"props.controlObj.methods",{}),attributeList=_lodash2["default"].values(_lodash2["default"].get(_this,"props.controlObj.attributes",[])),eventsList=_lodash2["default"].values(_lodash2["default"].get(_this,"props.controlObj.events",{})),handlersList=_lodash2["default"].values(_lodash2["default"].get(_this,"props.controlObj.handlers",{})),importsList=_lodash2["default"].values(_lodash2["default"].get(_this,"props.controlObj.imports",{})),usageList=_lodash2["default"].reduce(_this.props.usageMaps,function(res,usageMap,curControlName){return shortControlName===curControlName.toLowerCase()?usageMap:res},{}),controlNameBreadCrumsDom=_lodash2["default"].map(controlName.split(/[:.]/),function(token,tokenIdx){return React.createElement("li",{key:token+"-"+tokenIdx},token)});return{v:React.createElement("div",{id:"control-detail-wrapper"},React.createElement("div",null,React.createElement("ol",{className:"breadcrumb"},controlNameBreadCrumsDom)),React.createElement("ul",{className:"nav nav-tabs",role:"tablist"},_this._getTabHeaderItem("tab-attributes","Attributes",attributeList,!0),_this._getTabHeaderItem("tab-dependencies","Dependencies",dependenciesMap),_this._getTabHeaderItem("tab-events","Events",eventsList),_this._getTabHeaderItem("tab-imports","Imports",importsList),_this._getTabHeaderItem("tab-handlers","Handlers",handlersList),_this._getTabHeaderItem("tab-methods","Methods",methodsMap),_this._getTabHeaderItem("tab-usages","Usages",usageList)),React.createElement("div",{className:"tab-content"},React.createElement("div",{role:"tabpanel",className:"tab-pane active",id:"tab-attributes"},React.createElement(_AttributesHandlerEventsTable2["default"],{name:"Attributes",properties:attributeList})),React.createElement("div",{role:"tabpanel",className:"tab-pane",id:"tab-dependencies"},React.createElement(_DependenciesDetailTable2["default"],{dependencies:dependenciesMap})),React.createElement("div",{role:"tabpanel",className:"tab-pane",id:"tab-events"},React.createElement(_AttributesHandlerEventsTable2["default"],{name:"Events",properties:eventsList})),React.createElement("div",{role:"tabpanel",className:"tab-pane",id:"tab-imports"},React.createElement(_AttributesHandlerEventsTable2["default"],{name:"Imports",properties:importsList})),React.createElement("div",{role:"tabpanel",className:"tab-pane",id:"tab-handlers"},React.createElement(_AttributesHandlerEventsTable2["default"],{name:"Handlers",properties:handlersList})),React.createElement("div",{role:"tabpanel",className:"tab-pane",id:"tab-methods"},React.createElement(_MethodTable2["default"],{methodsMap:methodsMap})),React.createElement("div",{role:"tabpanel",className:"tab-pane",id:"tab-usages"},React.createElement(_UsageTable2["default"],{selectedControlName:controlName,usage:usageList}))))}}();return"object"===("undefined"==typeof _ret?"undefined":_typeof(_ret))?_ret.v:void 0},shouldComponentUpdate:function(nextProps,nextState){return!0},_getTabHeaderItem:function(tabContentId,headerName,entityObjects,active){var entityCount=_lodash2["default"].size(entityObjects),tabPlainText=headerName+" "+this._getCountBadge(entityCount);return React.createElement("li",{role:"presentation",className:active?"active":""},React.createElement("a",{href:"#"+tabContentId,"aria-controls":"settings",role:"tab","data-toggle":"tab"},tabPlainText))},_getCountBadge:function(countNum){return countNum>0?"["+countNum+"]":""}}),DependenciesPage=React.createClass({displayName:"DependenciesPage",getInitialState:function(){var searchTerm=_util2["default"].getSearchTerm(location.href),flattenDependencies=_util2["default"].flattenDependencies(this.props.dataDependenciesMap),myInitState={flattenDependencies:flattenDependencies,searchTerm:searchTerm,matchedControls:_util2["default"].findMatchingControl(flattenDependencies,searchTerm),selectedControlName:"",selectedControlObj:{}};return 1===_lodash2["default"].size(myInitState.matchedControls)&&(myInitState.selectedControlName=_lodash2["default"].keys(myInitState.matchedControls)[0],myInitState.selectedControlObj=myInitState.matchedControls[myInitState.selectedControlName]),myInitState},render:function(){return React.createElement("div",null,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 mb15"},React.createElement("div",{className:"input-group"},React.createElement("span",{className:"input-group-addon",id:"search-term-input"},"Search Term"),React.createElement("input",{type:"text",value:this.state.searchTerm,onChange:this.onSearchTermChanged,className:"form-control",placeholder:"Enter text to search... (<namespace>:<control>)","aria-describedby":"search-term-input"})))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-4"},React.createElement("div",{id:"search-matches-wrapper",className:"panel panel-success"},React.createElement("div",{className:"panel-heading"},React.createElement("h3",{className:"panel-title"},"Matching Searches",React.createElement("span",{className:"badge pull-right"},_lodash2["default"].size(this.state.matchedControls)," matches"))),React.createElement("div",{className:"panel-body"},React.createElement(_ListView2["default"],{data:this.state.matchedControls,onRowSelection:this.onViewControlDetail,selectedItem:this.state.selectedControlName})))),React.createElement("div",{id:"control-detail-wrapper",className:"col-sm-8"},React.createElement(ControlDetailPage,{controlName:this.state.selectedControlName,controlObj:this.state.selectedControlObj,usageMaps:this.props.usageMaps}))))},onSearchTermChanged:function(_ref){var newSearchTerm=_ref.target.value;newSearchTerm=newSearchTerm.toLowerCase(),this.setState({searchTerm:newSearchTerm,matchedControls:_util2["default"].findMatchingControl(this.state.flattenDependencies,newSearchTerm)})},onViewControlDetail:function(controlName){this.setState({selectedControlName:controlName,selectedControlObj:this.state.matchedControls[controlName]})}});_util2["default"].render(function(){var dataDependenciesMap=_restClient2["default"].getDataDependenciesMap(),usageMaps=_restClient2["default"].getUsageMap();ReactDOM.render(React.createElement(DependenciesPage,{dataDependenciesMap:dataDependenciesMap,usageMaps:usageMaps}),document.querySelector("#body"))});