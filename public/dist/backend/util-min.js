"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _mustache=require("mustache"),_mustache2=_interopRequireDefault(_mustache),_fs=require("fs"),_fs2=_interopRequireDefault(_fs),_path=require("path"),_path2=_interopRequireDefault(_path),_lodash=require("lodash"),_lodash2=_interopRequireDefault(_lodash),_q=require("q"),_q2=_interopRequireDefault(_q),_logger=require("./logger"),_logger2=_interopRequireDefault(_logger),self={_getSimplePathString:function(path){var pathString="";try{var pathSplits=path.split("/");pathString=[pathSplits[pathSplits.length-3],pathSplits[pathSplits.length-1]].join("/")}catch(ex){}return pathString},getComponentNamesFromPath:function(path){var shortenPath=self._getSimplePathString(path);return[shortenPath.substr(0,shortenPath.indexOf("/")),shortenPath.substr(shortenPath.indexOf("/")+1)]},getTemplateFunc:function(templateStr){return _mustache2["default"].render.bind(void 0,templateStr)},readFromFileAsync:function(path){var defer=_q2["default"].defer();return _logger2["default"].debug("Reading file...".magenta.bold,self._getSimplePathString(path).yellow),defer.resolve(_fs2["default"].readFileSync(path,"utf-8")),_fs2["default"].readFile(path,"utf-8",function(error,fileContent){error?(_logger2["default"].log("[ReadFile Error]".red,path+": cannot be read"),defer.resolve("")):defer.resolve(fileContent)}),defer.promise},listDir:function listDir(inputDir,inputRes){var defer=_q2["default"].defer(),dirs=_fs2["default"].readdirSync(inputDir);return inputRes=_lodash2["default"].reduce(dirs,function(res,curDir){var newDir=_path2["default"].join(inputDir,curDir);if(_fs2["default"].lstatSync(newDir).isDirectory())listDir(newDir,res);else{if(newDir.indexOf("/target/")>=0)return res;var extension=_path2["default"].extname(newDir),destinationBucket=void 0;switch(extension){case".cmp":destinationBucket="cmp";break;case".app":destinationBucket="app";break;case".evt":destinationBucket="evt";break;case".js":destinationBucket="js",newDir.indexOf("Helper.js")>=0?destinationBucket="helperjs":newDir.indexOf("Controller.js")>=0?destinationBucket="controllerjs":newDir.indexOf("Renderer.js")>=0&&(destinationBucket="rendererjs")}destinationBucket&&(res[destinationBucket]||(res[destinationBucket]=[]),res[destinationBucket].push(newDir))}return res},inputRes||{}),defer.resolve(inputRes),defer.promise},getBaseFileNameWithoutExtension:function(fileName){var shortFileName=_path2["default"].basename(fileName);return shortFileName.substr(0,shortFileName.indexOf("."))},getKeyValFromCheerioDom:function(cheerioDom){return[cheerioDom.attribs.name,cheerioDom.attribs]},writeToFile:function(string,path,isAppend){_logger2["default"].debug(path.yellow),isAppend===!0?_fs2["default"].appendFileSync(path,string):_fs2["default"].writeFileSync(path,string)},serializeJsonObject:function(jsonObj){return JSON.stringify(jsonObj,null,1)},isValidDependencies:function(componentFullName){return componentFullName.indexOf(":")>=0?!0:!1},getControlRelativePath:function(fileName){return fileName.substr(fileName.indexOf("/src/"))},mkDir:function(dir){_fs2["default"].mkdirSync(dir)},appendUsageMapByName:function(usageMap,parentName,childrenName,newUsageObj){usageMap[parentName]=usageMap[parentName]||{},usageMap[parentName][childrenName]=usageMap[parentName][childrenName]||[],usageMap[parentName][childrenName].push(newUsageObj)},appendDependenciesPropInControlObj:function(curControlObj,depdenciesName,attribs){curControlObj.dependencies[depdenciesName]=curControlObj.dependencies[depdenciesName]||[],curControlObj.dependencies[depdenciesName].push(attribs)},addNamespaceCountMapEntry:function(namespaceCountMap,controlNameSpace,delta){namespaceCountMap[controlNameSpace]=namespaceCountMap[controlNameSpace]||0,namespaceCountMap[controlNameSpace]+=delta},addControlCountMapEntry:function(controlCountMap,depdenciesName,delta){controlCountMap[depdenciesName]=controlCountMap[depdenciesName]||0,controlCountMap[depdenciesName]+=delta},setDependenciesMapEntry:function(dependenciesMap,controlNameSpace,controlName,curControlObj){dependenciesMap[controlNameSpace]=dependenciesMap[controlNameSpace]||{},dependenciesMap[controlNameSpace][controlName]=curControlObj}};exports["default"]=self;